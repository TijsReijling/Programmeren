---
title: "Income Inequality and Its Impact on Health and Life Expectancy Across Socioeconomic Groups in the Netherlands"
author:
  - "Sarah Driessens 2854343, Luke Eising 2645467, Xander von Freytag Drabbe 2859036"
  - "Tijs Reijling 2854229, Haris Semen 2670607, Bas van Wijk 2864018, Selim Yakali 2777497"
date: "`r Sys.Date()`"
output:
  pdf_document: default
---

# Set-up your environment

```{r package_install, include=FALSE}
if (!requireNamespace("tidyverse", quietly = TRUE)) install.packages("tidyverse")
if (!requireNamespace("yaml", quietly = TRUE)) install.packages("yaml")
if (!requireNamespace("rmarkdown", quietly = TRUE)) install.packages("rmarkdown")
if (!requireNamespace("dplyr", quietly = TRUE)) install.packages("dplyr")
if (!requireNamespace("cbsodataR", quietly = TRUE)) install.packages("cbsodataR")
if (!requireNamespace("sf", quietly = TRUE)) install.packages("sf")
if (!requireNamespace("readr", quietly = TRUE)) install.packages("readr")
```

```{r packages}
library(tidyverse)
library(rmarkdown)
library(yaml)
library(dplyr)
library(cbsodataR)
library(sf)
library(readr)
```

# Title Page

Sarah Driessens, Luke Eising, Xander von Freytag Drabbe,\
Tijs Reijling, Haris Semen, Bas van Wijk & Selim Yakali

Tutorial group 4

C. Schouwenaar

# Part 1 - Identify a Social Problem

## 1.1 Describe the Social Problem

Topic: How does income inequality contribute to differences in health and life expectancy between high- and low-income groups in the Netherlands?

In the Netherlands, healthcare is universally granted to all citizens through mandatory health insurance. The government promotes healthcare equality through regulations that ensures equal access to services by prohibiting insurance companies to decline clients. Yet, low-income groups in the Netherlands still experience worse health outcomes than their wealthier counterparts.

Research by the Ministry of Health, Welfare and Sport shows that college or university-educated people, which correlates with a higher income, consistently score higher on health outcomes. VZinfo found that people with primary or VMBO-level education were significantly more likely to smoke, have obesity, and rate their health as “poor” compared to their higher educated peers (VZinfo, 2023).

Institutions like the CBS document imbalances between income level and life expectancy. Their analyses show that the wealthiest group in society lives, on average, eight years longer and spend 25 more years in good health than those in the lowest-income group. (Centraal Bureau voor de Statistiek [CBS], 2022).

Pharos provides us with more disparities by emphasising socio-economic differences in health. According to Pharos, receiving welfare benefits correlates with poorer health. They state that with each step up on the social ladder, their chance of good health increases (Pharos, 2022). These health differences across different income groups undermine social cohesion, which makes health inequality based on ones health a social problem that needs to be examined.

Why is this relevant? Wealth inequality in the Netherlands is growing, making these differences even more apparent. Factors like increasing housing costs, job security and education gaps contribute to the widening differences between low- and high-income individuals.

This debate about health inequality isn’t new. Some policy makers have been proposing to cut deductibles (eigen risico) since they contribute to people with lower incomes delaying their care. We aim to analyse this inequality to quantify how large these differences are and identify their potential causes.

What has not been examined extensively is whether this inequality holds true across Dutch municipalities. Our aim is to analyse if this inequality hold true throughout the Netherlands, and identify regional differences in the relationship between wealth and health.

# Part 2 - Data Sourcing

## 2.1 Load in the data

[Google Drive URL with all data](https://drive.google.com/drive/folders/1rvVdds73_eQvnOZ_qclV67XdjTwQfReh?usp=sharing)

```{r message=FALSE, warning=FALSE}
setwd("~/GitHub/Programmeren/data")

Welzijn_Goed <- read_csv("Welzijn.goed.csv")

Ervaren_Gezondheid <- read_csv("Ervaren_Gezondheid.csv")

Levensverwachting <- read_csv("Levensverwachting.csv")

Ervaren_gezondheid_wijk <- read_delim("Ervarengezondheid_Wijk&Buurt.csv", delim = ";")

Inkomen_per_gemeente <- read_delim("Inkomen_gemeente.csv", delim = ";")

Levensverwachting_Gemeente <- read_delim("Levensverwacht_Gemeente_Wijk&Buurt.csv", delim = ";")

ErvarenGezondheidNL <- read_csv("ErvarenGezondheidNL.csv")
```

```{r message=FALSE, warning=FALSE, include=FALSE}
gemeentegrenzen <- sf::st_read("https://service.pdok.nl/cbs/gebiedsindelingen/2023/wfs/v1_0?request=GetFeature&service=WFS&version=1.0.0&typeName=gemeente_gegeneraliseerd&outputFormat=application/json")
```

## 2.2 Provide a short summary of the datasets

### Welzijn dataset

```{r}
head(Welzijn_Goed)

```

This data set contains and presents figures on the wellness/well-being of the population of the Netherlands aged 18 years or older. This factors in happiness and satisfaction with life, satisfaction with education, work, travel, daily activities, weight, financial situation, housing, living environment social life and total amount of time spent on leisure. In addition, concerns about financial future, feelings of insecurity and trust in others are included. This data can be categorized by gender, age, education level and origin.

[URL of the data download page](https://opendata.cbs.nl/statline/portal.html?_la=nl&_catalog=CBS&tableId=85542NED&_theme=178) + Metadata

### Ervaren Gezondheid dataset

The table contains estimated percentages of indicators related to health, social situation, and lifestyle at neighborhood, district, and municipal levels, based on a conducted survey.

[URL of the data download page](https://statline.rivm.nl/portal.html?_la=nl&_catalog=RIVM&tableId=50120NED&_theme=94) + Metadata

### Levensverwachting dataset

This dataset provides us with information about the life expectancy across different periods between 1996-2022.The numbers are provided on a national and municipal level. The data at the municipal level are calculated on the basis of a 4-year period.

[URL of the data download page](https://statline.rivm.nl/portal.html?_la=nl&_catalog=RIVM&tableId=50132NED&_theme=101) + Metadata

### Ervaren Gezondheid 'Wijken' & 'Buurten' dataset

The table contains self-reported health indicators through a questionnaire about health, social situation, and lifestyle at neighborhood, district, and municipal levels. The average of all people living in a municipality or neighbourhood is computed.

[URL of the data download page](https://statline.rivm.nl/portal.html?_la=nl&_catalog=RIVM&tableId=50120NED&_theme=94) + Metadata

### Inkomen Gemeentes dataset

For each household within a municipality or neighbourhood, the total household income was calculated and then divided by the number of household members. This results in the average income per person, which accounts for differences in household size and provides a more accurate measure of individual economic well-being.

[URL of the data download page](https://www.cbs.nl/nl-nl/maatwerk/2023/35/inkomen-per-gemeente-en-wijk-2020) + Metadata

## 2.3 Describe the type of variables included

Our data sets come from the CBS, an independent administrative body of the Dutch government. CBS is responsible for providing the public with unbiased, statistical information. Their data sets have a wide sample pool which ensure reliability and relevance for our project.

Our sources provide us with data about life expectancy, experienced health (ervaren gezondheid), and income at national, municipal, and neighbourhood levels. These datasets complement each other well because of their recent publication dates (2020+), making them very suitable for integrating them in our analysis. they also provide us with information about the health and income/wealth of Dutch citizens on different levels, allowing us to assign one indicator of health (like experienced health or life expectancy), with an income indicator (like income or net worth). Someone’s health or wealth is very difficult to quantify, because there are many different factors at play. Why we decided on these datasets is because we think that they provide us with the most relevant variables when wanting to measure those things.

Despite their recent publication, they are still collected in different years. Large global or national events (like COVID-19) may have affected the data. These events could impact our data, skewing our results. Also life expectancy and Experienced health are not perfect indicators for ones health. For example, life expectancy is heavily impacted by one’s genetics, so income might have little influence in this. The life expectancy could also vary due to accidents. If one group of people get in fatal accidents more often, than this could also impact their life expectancy. experienced health also has an obvious flaw, they are based of reports that are not made by an export. That means that the values gives by participants is inherently inaccurate.

# Part 3 - Quantifying

## 3.1 Data cleaning

Before we could start visualising or comparing anything, a lot of time went into cleaning and preparing the data. Since each dataset came from a different source or year, we had to make sure everything matched up correctly. We decided to average all well-being data from 2015 to 2018 and give it the label “2016”, we also renamed the 2015-2018 column to "2016" from our levensverwachting dataset. Having done so, we could merge it with other data that only had figures for that year. This wasn't ideal, since we lost some of the yearly detail, but it made the merge possible and gave us a cleaner dataset to work with.

A big part of the process was making sure the columns matched; Both in name and in format. Some variables were written with commas instead of dots, others had strange region codes or inconsistent naming. We fixed those manually, recoded some labels to make them easier to work with, and removed rows or columns that weren’t relevant for our analysis. In doing so, we tried to strike a balance between keeping the data as complete as possible, while also making it manageable.

There were some annoying issues along the way, like missing values, misaligned categories, or weird formatting, but we handled those as they came up. A lot of them we solved by converting text into numbers, standardising names, or taking averages while skipping missing values.

Ideally, these datasets would have been fully standardised to begin with, but that’s rarely the case when using open government data. In the end, our cleaning steps gave us a solid foundation to build visualisations and correlations on. This work was essential for making sure everything lined up properly, across years, groups, and regions, so the patterns we explore later actually reflect something real.

```{r, include=FALSE}
Levensverwachting <- Levensverwachting[grepl("2015G400", Levensverwachting$Perioden),]
Welzijn_Goed <- Welzijn_Goed[Welzijn_Goed$Perioden %in% c("2015JJ00", "2016JJ00", "2017JJ00", "2018JJ00"), ]
```

```{r, include=FALSE, warning=FALSE}
Welzijn_averages <- Welzijn_Goed %>%
  group_by(Kenmerken, Marges) %>%
  summarise(
    Perioden = "2015–2018",
    across(where(is.numeric), mean, na.rm = TRUE),
    .groups = "drop" ) 
```

```{r include=FALSE}
setdiff(names(Welzijn_Goed), names(Welzijn_averages))

sapply(Welzijn_Goed[setdiff(names(Welzijn_Goed), names(Welzijn_averages))], class)
```

```{r include=FALSE}
Welzijn_Goed <- Welzijn_Goed %>%
  mutate(across(all_of(c(
    "ScoreTevredenheidMetWerk_13", "Ontevreden_14", "NietTevredenNietOntevreden_15",
    "Tevreden_16", "ScoreTevredenheidMetReistijd_17", "Ontevreden_18",
    "NietTevredenNietOntevreden_19", "Tevreden_20", "ScoreTevredenheidDagelijkseBezigheden_21",
    "Ontevreden_22", "NietTevredenNietOntevreden_23", "Tevreden_24", "Ontevreden_58"
  )), ~ as.numeric(as.character(.))))
```

```{r include=FALSE}
Welzijn_averages <- Welzijn_Goed %>%
  group_by(Kenmerken, Marges) %>%
  summarise(
    Perioden = "2015–2018",
    across(where(is.numeric), mean, na.rm = TRUE),
    .groups = "drop") 
```

```{r, include=FALSE}
Ervaren_Gezondheid <- Ervaren_Gezondheid[
  Ervaren_Gezondheid$Gemeentenaam_1 %in% c("Amsterdam", "Rotterdam") &
    Ervaren_Gezondheid$SoortRegio_2 == "Gemeente",]
```

```{r, include=FALSE}
Ervaren_Gezondheid_2016 <- Ervaren_Gezondheid[Ervaren_Gezondheid$Perioden == "2016JJ00", ]
```

```{r, include=FALSE}
Levensverwachting_2016 <- Levensverwachting %>%
  filter(Marges == "MW00000", Perioden == "2015G400") %>%
  mutate(Perioden = "2016")
```

```{r, include=FALSE}
Welzijn_averages_2016 <- Welzijn_averages %>%
  filter(Marges == "MW00000", Perioden == "2015–2018") %>%
  mutate(Perioden = "2016")
```

```{r, include=FALSE}
Levensverwachting_2016_renamed <- Levensverwachting_2016 %>%
  rename(Kenmerken = InkomenEnWelvaart)
```

```{r, include=FALSE}
Levensverwachting_2016_renamed <- Levensverwachting_2016_renamed %>%
  mutate(Kenmerken = as.character(Kenmerken))

Welzijn_averages_2016 <- Welzijn_averages_2016 %>%
  mutate(Kenmerken = as.character(Kenmerken))
```

```{r include=FALSE}
merged_data <- full_join(
  Levensverwachting_2016_renamed,
  Welzijn_averages_2016,
  by = c("Kenmerken", "Perioden"))
```

```{r include=FALSE}
Ervaren_Gezondheid$ErvarenGezondheidGoedZeerGoed_4 <-
  as.numeric(as.character(Ervaren_Gezondheid$ErvarenGezondheidGoedZeerGoed_4))
```

```{r include=FALSE}
Welzijn_index_2016 <- Welzijn_averages_2016 %>%
  select(
    Kenmerken, Marges, Perioden,
    ScoreGeluk_1,
    ScoreTevredenheidMetHetLeven_5,
    ScoreTevredenheidMetWerk_13,
    ScoreTevredenheidDagelijkseBezigheden_21,
    ScoreTevredenheidMetLichGezondheid_25,
    ScoreTevredenheidPsychischeGezondheid_29,
    ScoreTevredenheidMetSociaalLeven_57
  )
```

```{r include=FALSE}
Welzijn_index_2016 <- Welzijn_index_2016 %>%
  mutate(
    WelzijnIndex = rowMeans(select(., 
                                   ScoreGeluk_1,
                                   ScoreTevredenheidMetHetLeven_5,
                                   ScoreTevredenheidMetWerk_13,
                                   ScoreTevredenheidDagelijkseBezigheden_21,
                                   ScoreTevredenheidMetLichGezondheid_25,
                                   ScoreTevredenheidPsychischeGezondheid_29,
                                   ScoreTevredenheidMetSociaalLeven_57
    ), na.rm = TRUE)
  )
```

```{r, include=FALSE}
Welzijn_index_2016 <- Welzijn_index_2016 %>%
  select(Kenmerken, Marges, Perioden, WelzijnIndex)
```

```{r, include=FALSE}
Welzijn_naar_opleidingsniveau <- Welzijn_index_2016 %>%
  filter(Kenmerken %in% c(
    "2018710",  # Basisonderwijs
    "2018720",  # Vmbo, havo-, vwo-onderbouw, mbo1
    "2018750",  # Havo, vwo, mbo2-4
    "2018800",  # Hbo-, wo-bachelor
    "2018810"   # Hbo-, wo-master, doctor
  ))
```

```{r, include=FALSE}
Welzijn_naar_opleidingsniveau <- Welzijn_naar_opleidingsniveau %>%
  mutate(
    Opleidingsniveau = case_when(
      Kenmerken == "2018710" ~ "Basisonderwijs",
      Kenmerken == "2018720" ~ "Vmbo, havo-, vwo-onderbouw, mbo1",
      Kenmerken == "2018750" ~ "Havo, vwo, mbo2-4",
      Kenmerken == "2018800" ~ "Hbo-, wo-bachelor",
      Kenmerken == "2018810" ~ "Hbo-, wo-master, doctor",
      TRUE ~ NA_character_
    )
  )
```

```{r, include=FALSE}
Welzijn_naar_opleidingsniveau <- Welzijn_naar_opleidingsniveau %>%
  select(-Kenmerken) %>%
  relocate(Opleidingsniveau, .before = everything())
```

```{r, include=FALSE}
Levensverwachting_geslacht <- Levensverwachting_2016_renamed %>%
  filter(Geslacht %in% c(3000, 4000))
```

```{r, include=FALSE}
Levensverwachting_geslacht <- Levensverwachting_geslacht %>%
  mutate(
    Geslacht = case_when(
      Geslacht == 3000 ~ "Mannen",
      Geslacht == 4000 ~ "Vrouwen"
    ))
```

```{r, include=FALSE}
Levensverwachting_geslacht_gemiddeld <- Levensverwachting_geslacht %>%
  group_by(Geslacht) %>%
  summarise(
    Jaar = "2016",
    Levensverwachting = mean(Levensverwachting_1, na.rm = TRUE)
  )
```

```{r, include=FALSE}
Welzijn_naar_geslacht <- Welzijn_index_2016 %>%
  filter(Kenmerken %in% c(3000, 4000)) %>%
  mutate(
    Geslacht = case_when(
      Kenmerken == 3000 ~ "Mannen",
      Kenmerken == 4000 ~ "Vrouwen"
    )
  ) %>%
  select(Geslacht, Jaar = Perioden, WelzijnIndex)
```

```{r, include=FALSE}
Ultimate_dataset_of_doom_hell_and_destruction <- full_join(
  Levensverwachting_geslacht_gemiddeld,
  Welzijn_naar_geslacht,
  by = c("Geslacht", "Jaar")
)
```

```{r, include=FALSE}
Welzijn_naar_opleidingsniveau <- Welzijn_naar_opleidingsniveau %>%
  filter(Marges == "MW00000") %>%
  select(-Marges) %>%
  rename(Jaar = Perioden)
```

```{r, include=FALSE}
packages <- c("sf", "dplyr", "ggplot2", "readr", "tmap", "stringr")
installed <- rownames(installed.packages())
for (pkg in packages) {
  if (!pkg %in% installed) install.packages(pkg)
}
lapply(packages, library, character.only = TRUE)
```

```{r, include=FALSE}
setwd("~/GitHub/Programmeren/data")
```

```{r, include=FALSE}
gemeente_shape <- st_read(
  "https://service.pdok.nl/cbs/gebiedsindelingen/2020/wfs/v1_0?request=GetFeature&service=WFS&version=2.0.0&typeName=gemeente_gegeneraliseerd&outputFormat=json",
  quiet = TRUE)
```

```{r, include=FALSE}
gemeente_shape <- gemeente_shape %>%
  select(statcode, statnaam, geometry) %>%
  rename(GM_CODE = statcode, GM_NAAM = statnaam)
```

```{r, include=FALSE}
data <- read_csv("data/GemeentesJuist.csv", locale = locale(encoding = "UTF-8"))
```

```{r, include=FALSE}
gemeente_data <- data %>%
  filter(str_to_lower(SoortRegio_2) == "gemeente") %>%
  select(Gemeentenaam_1, ErvarenGezondheidGoedZeerGoed_4)
```

```{r, include=FALSE}
gemeente_shape$GM_NAAM <- str_to_lower(gemeente_shape$GM_NAAM)
gemeente_data$Gemeentenaam_1 <- str_to_lower(gemeente_data$Gemeentenaam_1)
```

```{r, include=FALSE}
kaart_data <- gemeente_shape %>%
  left_join(gemeente_data, by = c("GM_NAAM" = "Gemeentenaam_1"))
```

```{r, include=FALSE}
na_count <- sum(is.na(kaart_data$ErvarenGezondheidGoedZeerGoed_4))
cat("Aantal gemeenten zonder data: ", na_count, "\n")
```

```{r, include=FALSE}
kaart_data <- st_simplify(kaart_data, dTolerance = 100)
```

```{r, include=FALSE}
tmap_mode("plot")
```

```{r, include=FALSE}
Levensverwachting_2016_renamed_baby <- Levensverwachting_2016_renamed %>%
  filter(LeeftijdOp31December == "10010", Geslacht == "T001038") %>%
  mutate(Leeftijd = 0)
```

```{r, include=FALSE}
Levensverwachting_2016_renamed_baby <- Levensverwachting_2016_renamed_baby %>%
  select(-Marges, -Geslacht, -LeeftijdOp31December)
```

```{r, include=FALSE}
Levensverwachting_2016_renamed_baby <- Levensverwachting_2016_renamed_baby %>%
  rename(Jaar = Perioden)
```

```{r, include=FALSE}
welvaart_codes <- c(2021770, 2021780, 2021790, 2021800, 2021810)

Levensverwachting_2016_renamed_baby <- Levensverwachting_2016_renamed_baby %>%
  filter(Kenmerken %in% welvaart_codes)
```

```{r, include=FALSE}
Levensverwachting_2016_renamed_baby <- Levensverwachting_2016_renamed_baby %>%
  arrange(Kenmerken) %>%
  mutate(WelvaartQuintiles = c("1st quintile", "2nd quintile", "3rd quintile", "4th quintile", "5th quintile"))
```

```{r, include=FALSE}
Levensverwachting_2016_renamed_baby <- Levensverwachting_2016_renamed_baby %>%
  select(Leeftijd, Jaar, WelvaartQuintiles, Levensverwachting_1)
```

```{r, include=FALSE}
Levensverwachting_2016_renamed_baby$Levensverwachting_1 <- as.numeric(as.character(Levensverwachting_2016_renamed_baby$Levensverwachting_1))
str(Levensverwachting_2016_renamed_baby)
```

```{r, include=FALSE}
Welzijn_naar_opleidingsniveau$Opleidingsniveau <- factor(
  Welzijn_naar_opleidingsniveau$Opleidingsniveau,
  levels = c(
    "Basisonderwijs",
    "Vmbo, havo-, vwo-onderbouw, mbo1",
    "Havo, vwo, mbo2-4",
    "Hbo-, wo-bachelor",
    "Hbo-, wo-master, doctor"
  )
)
```

```{r, include=FALSE}
ggplot(Welzijn_naar_opleidingsniveau, aes(x = Opleidingsniveau, y = WelzijnIndex, fill = Opleidingsniveau)) +
  geom_bar(stat = "identity", width = 0.7) +
  geom_text(
    aes(label = round(WelzijnIndex, 3)),   # 3 decimals
    vjust = -0.4,
    size = 4
  ) +
  scale_y_continuous(
    limits = c(0, 10),
    breaks = seq(0, 10, 1)
  ) +
  labs(
    title = "Well-being Index per Level of education (The Netherlands, 2016)",
    x = "Education level",
    y = "Well-being Index (scale of 1-10)"
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 30, hjust = 1, size = 7),
    legend.position = "none"
  )
```

```{r, include=FALSE}
opleidingskenmerken <- c(2018710, 2018720, 2018750, 2018800, 2018810)
```

```{r, include=FALSE}
Welzijn_temporal_visualization <- Welzijn_Goed %>%
  filter(Kenmerken %in% opleidingskenmerken, Marges == "MW00000") %>%
  mutate(Jaar = as.numeric(substr(Perioden, 1, 4))) %>%
  rowwise() %>%
  mutate(WelzijnIndex = mean(c_across(c(
    ScoreGeluk_1,
    ScoreTevredenheidMetHetLeven_5,
    ScoreTevredenheidMetWerk_13,
    ScoreTevredenheidDagelijkseBezigheden_21,
    ScoreTevredenheidMetLichGezondheid_25,
    ScoreTevredenheidPsychischeGezondheid_29,
    ScoreTevredenheidMetSociaalLeven_57
  )), na.rm = TRUE)) %>%
  ungroup() %>%
  select(Kenmerken, Jaar, WelzijnIndex)
```

```{r, include=FALSE}
Welzijn_temporal_visualization <- Welzijn_temporal_visualization %>%
  mutate(
    Opleidingsniveau = case_when(
      Kenmerken == 2018710 ~ "Basisonderwijs",
      Kenmerken == 2018720 ~ "Vmbo, havo-, vwo-onderbouw, mbo1",
      Kenmerken == 2018750 ~ "Havo, vwo, mbo2-4",
      Kenmerken == 2018800 ~ "Hbo-, wo-bachelor",
      Kenmerken == 2018810 ~ "Hbo-, wo-master, doctor",
      TRUE ~ NA_character_
    )
  ) %>%
  select(Opleidingsniveau, Jaar, WelzijnIndex)
```

```{r, include=FALSE}
Welzijn_temporal_visualization$Opleidingsniveau <- factor(
  Welzijn_temporal_visualization$Opleidingsniveau,
  levels = c(
    "Hbo-, wo-master, doctor",
    "Hbo-, wo-bachelor",
    "Havo, vwo, mbo2-4",
    "Vmbo, havo-, vwo-onderbouw, mbo1",
    "Basisonderwijs"
  )
)
```

```{r, include=FALSE}
ggplot(Welzijn_temporal_visualization, aes(x = Jaar, y = WelzijnIndex, color = Opleidingsniveau, group = Opleidingsniveau)) +
  geom_line(size = 1.2) +
  geom_point(size = 2) +
  scale_x_continuous(breaks = 2015:2018) +
  scale_color_manual(
    values = c(
      "Basisonderwijs" = "#F8766D",
      "Vmbo, havo-, vwo-onderbouw, mbo1" = "#C49A00",
      "Havo, vwo, mbo2-4" = "#00BA38",
      "Hbo-, wo-bachelor" = "#00BFC4",
      "Hbo-, wo-master, doctor" = "#C77CFF"
    )
  ) +
  labs(
    title = "Evolution of Well-being Index per Level of Education (2015–2018)",
    x = "Year",
    y = "Well-being Index",
    color = "Education level"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 9, face = "bold", hjust = 0.5),
    axis.title.x = element_text(margin = margin(t = 10)),
    axis.title.y = element_text(margin = margin(r = 10))
  )
```

```{r, include=FALSE}
ggplot(Ervaren_Gezondheid, 
       aes(x = Perioden, y = ErvarenGezondheidGoedZeerGoed_4,
           colour = Gemeentenaam_1, group = Gemeentenaam_1)) +
  
  geom_line(size = 1.5) +
  geom_text(aes(label = ErvarenGezondheidGoedZeerGoed_4),
            colour = "black", vjust = -1, show.legend = FALSE) +
  geom_point(colour = "black", size = 2.5, show.legend = FALSE) +
  geom_segment(aes(x = 2, xend = 2, y = 68.4 - 1.7, yend = 68.4 + 2.1), 
               color = "black", linewidth = 0.4) +
  annotate("text", x = 2, y = 69.9 - 3.3, label = "Rotterdam Vitaal en Healthy", 
           color = "black", angle = 0, vjust = 1, size = 3) +
  geom_segment(aes(x = 2.33, xend = 2.33, y = 73.8 - 0.4, yend = 73.8 + 2.8), 
               color = "black", linewidth = 0.4) +
  annotate("text", x = 2.25, y = 79 - 1.3, label = "Amsterdam Vitaal & Gezond", 
           color = "black", angle = 0, vjust = 1, size = 3) +
  scale_colour_manual(values = c("Amsterdam" = "#C41230", "Rotterdam" = "#39B54A")) +
  scale_x_discrete(label = c(2012, 2016, 2020)) +
  scale_y_continuous(limits = c(65, 80), breaks = seq(0, 100, 5)) +
  
  labs(
    x = "Year (2012, 2016, 2020)", 
    y = "Perceived Health (% Good or Very Good)",
    title = "Perceived Health per Municipality (2012-2020)",
    colour = "Municipality"
  ) +
  theme_minimal() +
  theme(legend.position = "bottom")
```

```{r, include=FALSE}
plot_data <- Ultimate_dataset_of_doom_hell_and_destruction %>%
  select(Geslacht, Levensverwachting, WelzijnIndex) %>%
  pivot_longer(
    cols = c("Levensverwachting", "WelzijnIndex"),
    names_to = "Metric",
    values_to = "Value"
  ) %>%
  mutate(
    Metric = recode(Metric,
                    "Levensverwachting" = "Life Expectancy",
                    "WelzijnIndex" = "Well-Being Index"
    ),
    Label = round(Value, 2)
  )
```

```{r, include=FALSE}
plot_data$Geslacht <- factor(plot_data$Geslacht, levels = c("Mannen", "Vrouwen"))
```

```{r, include=FALSE}
Inkomen_per_wijk <- Inkomen_per_gemeente
Inkomen_per_wijk <- Inkomen_per_wijk %>%
  filter(Regionaam != "Totaal")
Inkomen_per_wijk <- Inkomen_per_wijk %>%
  filter(Wijkcode != "Totaal")
```

```{r, include=FALSE}
Ervaren_gezondheid_wijk <- Ervaren_gezondheid_wijk %>%
  rename(Wijkcode = Codering_3, statnaam = Gemeentenaam_1)
```

```{r, include=FALSE}
Ervaren_gezondheid_wijk$SoortRegio_2 <- trimws(Ervaren_gezondheid_wijk$SoortRegio_2)
Ervaren_gezondheid_wijk <- Ervaren_gezondheid_wijk %>%
  mutate(Wijkcode = trimws(toupper(Wijkcode)))
Ervaren_gezondheid_wijk <- filter(Ervaren_gezondheid_wijk, SoortRegio_2 %in% c("Gemeente", "Wijk"))
```

```{r, include=FALSE}
Ervaren_gezondheid_wijk <- Ervaren_gezondheid_wijk %>%
  filter(SoortRegio_2 == "Wijk")
```

```{r, include=FALSE}
gemeente_wijk_data <- inner_join(
  Inkomen_per_wijk, Ervaren_gezondheid_wijk, by = "Wijkcode") %>%
  select(statnaam, Regionaam, Wijkcode, Gemiddeld, ErvarenGezondheidGoedZeerGoed_4)
```

```{r, include=FALSE}
gemeente_wijk_data$ErvarenGezondheidGoedZeerGoed_4 <- as.numeric(gsub(",", ".", gemeente_wijk_data$ErvarenGezondheidGoedZeerGoed_4))
gemeente_wijk_data$Gemiddeld <- as.numeric(gsub(",", ".", gemeente_wijk_data$Gemiddeld))
```

```{r, include=FALSE}
gemeente_cor <- gemeente_wijk_data %>%
  group_by(statnaam) %>%
  filter(n() >= 3) %>%
  summarise(
    correlation = if (sum(complete.cases(as.numeric(Gemiddeld, ErvarenGezondheidGoedZeerGoed_4))) > 1)
    {cor(as.numeric(Gemiddeld), as.numeric(ErvarenGezondheidGoedZeerGoed_4), use = "complete.obs")} 
    else {NA_real_})
```

```{r, include=FALSE}
gemeentegrenzen <- gemeentegrenzen %>%
  mutate(statnaam = tolower(trimws(statnaam)))
gemeente_cor <- gemeente_cor %>%
  mutate(statnaam = tolower(trimws(statnaam)))
```

```{r, include=FALSE}
gemeente_wijk_mapdata <- gemeentegrenzen %>%
  left_join(gemeente_cor, by = "statnaam")
```

```{r, include=FALSE}
Inkomen_per_gemeente <- filter(Inkomen_per_gemeente, Wijkcode == "Totaal")
Levensverwachting_Gemeente <- filter(Levensverwachting_Gemeente, Perioden == "2019G400") #2019G400 = gemiddelde van 2019/2022
Levensverwachting_Gemeente <- filter(Levensverwachting_Gemeente, Geslacht == "T001038") #T001038 = Man + Vrouw
Levensverwachting_Gemeente <- filter(Levensverwachting_Gemeente, Marges == "MW00000") #MW00000 = Waarde
Levensverwachting_Gemeente <- filter(Levensverwachting_Gemeente, Leeftijd == "10010") #10010 = 0 jarige

Levensverwachting_Gemeente <- Levensverwachting_Gemeente %>%
  filter(RegioS %in% Inkomen_per_gemeente$Gemeentecode)
```

```{r, include=FALSE}
gemeente_data <- left_join(Inkomen_per_gemeente, Levensverwachting_Gemeente, by = c("Gemeentecode" = "RegioS"))
```

```{r, include=FALSE}
gemeente_mapdata <- left_join(gemeentegrenzen, gemeente_data, by = c("statcode" = "Gemeentecode"))
```

```{r, include=FALSE}
gemeente_mapdata$Gemiddeld <- as.numeric(gsub(",", ".", gemeente_mapdata$Gemiddeld)) #commas omzetten naar punten
gemeente_mapdata$Levensverwachting_1 <- as.numeric(gemeente_mapdata$Levensverwachting_1)

cor(gemeente_mapdata$Levensverwachting_1, gemeente_mapdata$Gemiddeld, use = "complete.obs")
```

```{r, include=FALSE}
Ervaren_Gezondheid <- Ervaren_Gezondheid[
  Ervaren_Gezondheid$Gemeentenaam_1 %in% c("Amsterdam", "Rotterdam") &
    Ervaren_Gezondheid$SoortRegio_2 == "Gemeente",]
```

```{r, include=FALSE}
Ervaren_Gezondheid <- Ervaren_Gezondheid %>%
  select(-Gemeentenaam_1, -SoortRegio_2, -Codering_3)

Ervaren_Gezondheid_NL_AM_RO <- rbind(Ervaren_Gezondheid, ErvarenGezondheidNL)
```

```{r, include=FALSE}
Ervaren_Gezondheid_NL_AM_RO$ErvarenGezondheidGoedZeerGoed_4 <- 
  as.numeric(Ervaren_Gezondheid_NL_AM_RO$ErvarenGezondheidGoedZeerGoed_4)

Ervaren_Gezondheid_NL_AM_RO <- Ervaren_Gezondheid_NL_AM_RO %>%
  mutate(Region = case_when(
    WijkenEnBuurten == "GM0363" ~ "Amsterdam",
    WijkenEnBuurten == "GM0599" ~ "Rotterdam",
    WijkenEnBuurten == "NL01"   ~ "The Netherlands",
    TRUE ~ NA_character_ ))
```

## 3.2 Generate necessary variables

1st new variable\
\
We sought to be able to compare different sub-populations based on their (self-reported) well-being through a questionnaire. In the datasets we used the year periods that were both from 2015 till 2018, perfect for our analysis. However, we transformed the yearly statistics from 2015 till 2018 into an average over the 4 years and gave it the title of "2016". There were plans to merge with another dataset (Ervaren_Gezondheid) who did have the year 2016 and some other keys that aligned. This merge happened based on sex but did not end up being used for any graphs or analysis that we decided to keep in the rapport. So a note has to be made that the value that is used and given the name '2016' is really the average over those 4 years.\
\
After the averages were taken, we still had 65 columns of data. A lot of the columns were on different scales so we decided to create a new variable: Our 'WelzijnIndex'. We created a singular value from 7 of the columns of data all on the same 1 through 10 scale. This created a value that could be used to compare a lot of different sub-populations based on their well-being.\
One of which we most importantly will use in 3.5, where we visualize sub-population variation based on level of education.

```{r, eval=FALSE}
Welzijn_averages <- Welzijn_Goed %>%
  group_by(Kenmerken, Marges) %>%
  summarise(
    Perioden = "2015–2018",
    across(where(is.numeric), mean, na.rm = TRUE),
    .groups = "drop" ) 
```

```{r, eval=FALSE, include=FALSE}
Welzijn_index_2016 <- Welzijn_averages_2016 %>%
  select(
    Kenmerken, Marges, Perioden,
    ScoreGeluk_1,
    ScoreTevredenheidMetHetLeven_5,
    ScoreTevredenheidMetWerk_13,
    ScoreTevredenheidDagelijkseBezigheden_21,
    ScoreTevredenheidMetLichGezondheid_25,
    ScoreTevredenheidPsychischeGezondheid_29,
    ScoreTevredenheidMetSociaalLeven_57 )
```

```{r, eval=FALSE, include=FALSE}
Welzijn_index_2016 <- Welzijn_index_2016 %>%
  mutate(WelzijnIndex = rowMeans(select(., 
                                   ScoreGeluk_1,ScoreTevredenheidMetHetLeven_5,ScoreTevredenheidMetWerk_13,ScoreTevredenheidDagelijkseBezigheden_21,ScoreTevredenheidMetLichGezondheid_25,ScoreTevredenheidPsychischeGezondheid_29,ScoreTevredenheidMetSociaalLeven_57), na.rm = TRUE))
```

```{r, eval=FALSE}
Welzijn_index_2016 <- Welzijn_index_2016 %>%
  mutate(WelzijnIndex = rowMeans(select(.,
    ScoreGeluk_1,
    ScoreTevredenheidMetHetLeven_5,
    ScoreTevredenheidMetWerk_13,
    ScoreTevredenheidDagelijkseBezigheden_21,
    ScoreTevredenheidMetLichGezondheid_25,
    ScoreTevredenheidPsychischeGezondheid_29,
    ScoreTevredenheidMetSociaalLeven_57
  ), na.rm = TRUE))
```

```{r, eval=FALSE, include=FALSE}
Welzijn_index_2016 <- Welzijn_index_2016 %>%
  select(Kenmerken, Marges, Perioden, WelzijnIndex)
```

2nd new variable\
\
Correlation Between Income and Experienced Health:\
Our second variable calculates the correlation between experienced health and average income within each municipality. The two columns selected are: ErvarenGezondheidZeerGoed_4” (the percentage of people in a neighbourhood who grade their own health as good, or very good), and “Gemiddeld” (the average yearly wage in a neighbourhood divided by €1000).

These variables were passed through the “cor()” function to calculate the correlation between these two variables for each municipality. The correlation was only computed for municipalities that had three or more neighbourhoods (with valid data).

The decision to create this variable was to map how the relationship between health and income varies across municipalities in the Netherlands. This variable can be visualised on a heat map, helping us understand where and how income inequality contributes to differences in health.

```{r gen_var1, eval=FALSE, include=TRUE}
gemeente_cor <- gemeente_wijk_data %>%
  group_by(statnaam) %>%
  filter(n() >= 3) %>%
  summarise(
    correlation = if (sum(complete.cases(as.numeric(Gemiddeld, ErvarenGezondheidGoedZeerGoed_4))) > 1)
      {cor(as.numeric(Gemiddeld), as.numeric(ErvarenGezondheidGoedZeerGoed_4), use = "complete.obs")} 
    else {NA_real_})
```

## 3.3 Visualize temporal variation

```{r include=FALSE}
Ervaren_Gezondheid <- read.csv("Data/Ervaren_Gezondheid.csv")

Ervaren_Gezondheid <- Ervaren_Gezondheid[
  Ervaren_Gezondheid$Gemeentenaam_1 %in% c("Amsterdam", "Rotterdam") &
    Ervaren_Gezondheid$SoortRegio_2 == "Gemeente",]

Ervaren_Gezondheid$ErvarenGezondheidGoedZeerGoed_4 <- as.numeric(Ervaren_Gezondheid$ErvarenGezondheidGoedZeerGoed_4)
```

```{r side_by_side_plots, fig.show='hold', fig.width=6, fig.height=3, echo=FALSE}
print(ggplot(Ervaren_Gezondheid, 
       aes(x = Perioden, y = ErvarenGezondheidGoedZeerGoed_4,
           colour = Gemeentenaam_1, group = Gemeentenaam_1)) +
  geom_line(size = 1.5) +
  geom_text(aes(label = ErvarenGezondheidGoedZeerGoed_4),
            colour = "black", 
            vjust = -1,
            show.legend = F) +
  geom_point(colour = "black", size = 2.5, show.legend = F) +
  
  scale_colour_manual(values = c("#C41230", "#39B54A", "black")) +
  scale_x_discrete(label = c(2012, 2016, 2020)) +
  scale_y_continuous(
    limits = c(65, 80),
    breaks = seq(0, 100, by = 5)) +
  
  labs(x = "Year (2012, 2016, 2020)", 
       y = "Perceived Health (% Good or Very Good)",
       title = "Perceived Health per Municipality (2012-2020)",
       colour = "Municipality") +
  theme_minimal() +
  theme(legend.position = "bottom"))

print(ggplot(Ervaren_Gezondheid_NL_AM_RO, 
       aes(x = Perioden, y = ErvarenGezondheidGoedZeerGoed_4,
           colour = Region, group = Region)) +
  geom_line(size = 1.5) +
  geom_point(colour = "black", size = 2.5, show.legend = FALSE) +
  geom_text(aes(label = ErvarenGezondheidGoedZeerGoed_4,
                vjust = ifelse(Region == "The Netherlands", -0.8, 1.9)),
            colour = "black", 
            show.legend = FALSE) +
  scale_colour_manual(values = c(
    "Amsterdam" = "#C41230",
    "Rotterdam" = "#39B54A",
    "The Netherlands" = "orange"
  )) +
  scale_x_discrete(labels = c("2012", "2016", "2020")) +
  scale_y_continuous(limits = c(65, 80), breaks = seq(0, 100, by = 5)) +
  labs(
    x = "Year (2012, 2016, 2020)",
    y = "Perceived health (% wel or very well)",
    title = "Perceived Health per Municipality",
    colour = "Region"
  ) +
  theme_minimal() +
  theme(legend.position = "bottom"))
```

The Perceived Health per Municipality shows how the perceived health in different regions fluctuates across different time points. We see clear temporal patterns, with periods of increase and decrease indicating variability over time. This suggests that the underlying phenomenon is not static, but undergoes notable changes, highlighting the importance of considering temporal dynamics in the analysis.

Overall, we can see that the self-reported Perceived Health in the Netherlands hovered around 75-76% between the years 2012 and 2016, however, we can see a big increase between the years 2016-2020. This variation will be looked at in the "event analysis" section, to figure out why the changes can be so drastic on municipality level in relation to country-wide level.

## 3.4 Visualize spatial variation

```{r visualise_maps_side_by_side, fig.show='hold', fig.width=5.75, fig.height=2.5, echo=FALSE, message=FALSE, warning=FALSE}

ggplot(gemeente_wijk_mapdata) +
  geom_sf(aes(fill = correlation)) + 
  theme_minimal() +
  scale_fill_gradient2(high = "#6A0DAD", mid = "lightgrey", low = "#FFD700",
                       limits = c(-1, 1),
                       breaks = c(-1, -0.5, 0, 0.5, 1),
                       name = "Correlation 'income & health'") +
  theme(legend.position = "left") + 
  labs(caption = "Grey areas = insufficient data")
```

This heat map shows the strength of the correlation between the average income and experienced health across neighbourhoods within each municipality in the Netherlands. Municipalities that include fewer than three neighbourhoods with valid data are marked in grey. For each municipality with sufficient data (three or more neighbourhoods), a correlation coefficient was calculated using the “cor()” function. High correlation areas (dark purple) are mainly found in urban areas like Rotterdam and Groningen, whereas low correlation areas (yellow) are mainly found in rural areas such as Kapelle, Veere and Reimerswaal in Zeeland. These yellow areas are rare and are likely caused by data inconsistencies or an anomalies.

The prevalence of purple on the map indicates a moderate positive correlation between income and experienced health in most municipalities. Although it should be noted that correlation does not equal causation, we can confirm there exists a relation between the two.

One limitation of this map is the existence of grey areas that could not be computed due to a lack of data. In general, correlations are more accurate when they are based of a larger dataset. Therefore, we considered zooming out the map out and display it at the provincial level. However, we decided to not go with this approach, because it would lead to underrepresentation of urban areas by assigning them the same weight as less populated municipalities within each province. This issue could be solved by assigning weight to municipalities, but this would over complicate things. Additionally, keeping the map at the municipal level allows for a clearer visualisation of contrast between urban and rural areas.

## 3.5 Visualize sub-population variation

```{r visualise_subpopulations, echo=FALSE, fig.height=2.8, fig.width=6.15}
ggplot(Welzijn_temporal_visualization, aes(x = Jaar, y = WelzijnIndex, color = Opleidingsniveau, group = Opleidingsniveau)) +
  geom_line(size = 1.2) +
  geom_point(size = 2) +
  scale_x_continuous(breaks = 2015:2018) +
  scale_color_manual(
    values = c(
      "Basisonderwijs" = "#F8766D",
      "Vmbo, havo-, vwo-onderbouw, mbo1" = "#C49A00",
      "Havo, vwo, mbo2-4" = "#00BA38",
      "Hbo-, wo-bachelor" = "#00BFC4",
      "Hbo-, wo-master, doctor" = "#C77CFF"
    )
  ) +
  labs(
    title = "Evolution of Well-being Index per Level of Education (2015–2018)",
    x = "Year",
    y = "Well-being Index",
    color = "Education level"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 9, face = "bold", hjust = 0.5),
    axis.title.x = element_text(margin = margin(t = 10)),
    axis.title.y = element_text(margin = margin(r = 10))
  )
```

The graph we made displays the evolution of the new variable 'Well-being Index' from 2015 to 2018 across different education levels. It highlights consistent differences in perceived well-being among sub-populations based on one's level of education. Individuals with higher education report the highest levels of well-being throughout all years, while those with only primary education (“Basisonderwijs”) score the lowest and show more volatility over time.

By visualizing these trends, we gain insight into how well-being differs across groups of varying levels of education. This helps us identify which sub-populations may be more at risk of lower well-being, a factor often linked to broader issues such as poverty, inequality, and access to resources. This plot supports our overall aim of taking a closer look at social inqualities through data.

## 3.6 Event analysis

```{r include=FALSE}
Ervaren_Gezondheid <- read.csv("Data/Ervaren_Gezondheid.csv")

Ervaren_Gezondheid <- Ervaren_Gezondheid[
  Ervaren_Gezondheid$Gemeentenaam_1 %in% c("Amsterdam", "Rotterdam") &
    Ervaren_Gezondheid$SoortRegio_2 == "Gemeente",]
```

```{r Event_analysis, echo=FALSE, fig.height=3, fig.width=6}
Ervaren_Gezondheid$ErvarenGezondheidGoedZeerGoed_4 <- as.numeric(Ervaren_Gezondheid$ErvarenGezondheidGoedZeerGoed_4)
ggplot(Ervaren_Gezondheid, aes(x = Perioden, y = ErvarenGezondheidGoedZeerGoed_4, colour = Gemeentenaam_1, group = Gemeentenaam_1)) +

geom_line(size = 1.5) + geom_text(aes(label = ErvarenGezondheidGoedZeerGoed_4), colour = "black", vjust = -1, show.legend = FALSE) + geom_point(colour = "black", size = 2.5, show.legend = FALSE) +

geom_segment(aes(x = 2, xend = 2, y = 68.4 - 1.7, yend = 68.4 + 2.1), color = "black", linewidth = 0.4) + annotate("text", x = 2, y = 69.9 - 3.3, label = "Rotterdam Vitaal en Healthy", color = "black", angle = 0, vjust = 1, size = 3) +

geom_segment(aes(x = 2.33, xend = 2.33, y = 73.8 - 0.4, yend = 73.8 + 2.8), color = "black", linewidth = 0.4) + annotate("text", x = 2.25, y = 79 - 1.3, label = "Amsterdam Vitaal & Gezond", color = "black", angle = 0, vjust = 1, size = 3) +

scale_colour_manual(values = c("Amsterdam" = "#C41230", "Rotterdam" = "#39B54A")) + scale_x_discrete(label = c(2012, 2016, 2020)) + scale_y_continuous(limits = c(65, 80), breaks = seq(0, 100, 5)) +

labs( x = "Year (2012, 2016, 2020)", y = "Perceived Health (% Good or Very Good)", title = "Perceived Health per Municipality (2012-2020)", colour = "Municipality" ) + theme_minimal() + theme(legend.position = "bottom")
```

As indicated in the "Perceived Health per Municipality" diagram, before the 2020 reports, the “self-reported health” in 2016 and 2012 hovered around 74%. In 2017, the municipality of Amsterdam (in collaboration with many health insurers such as Zilveren Kruis, Sigra, Elaa, and others) started the initiative called “Amsterdam Vitaal & Gezond”. This initiative aims to ensure all residents have equal access to good health by 2040, adding 10 healthy life years for vulnerable groups through integrated care, digital solutions, prevention, and community partnerships. As seen by the self-reported health in 2020, the population of Amsterdam positively responded to this initiative, bringing the perceived health up to 78.2%.

Similarly, Rotterdam’s reported perceived health in 2012 and 2016, respectively, was 70.5% and 68.4%, in contrast to Amsterdam’s perceived health, dropping a handful of points throughout the 4 years. The municipality of Rotterdam had started its initiative, organized by VITR in collaboration with Erasmus, Hogeschool Rotterdam, and other health-focused institutes, in 2016. Similarly to Amsterdam’s initiative results, the perceived health drastically increased from 68.4% in 2016 to 74.1% in 2020, showcasing a clear positive reaction by the general public towards the initiatives.

# Part 4 - Discussion

Despite the Dutch government's commitment to universal healthcare and equal access to services, substantial differences in life expectancy and perceived health persist between socioeconomic groups. Research by CBS (2022) and VZinfo (2023) consistently shows that individuals with higher income and educational backgrounds experience better health and live longer than those in lower-income brackets. Pharos (2022) further underscores that socioeconomic status remains one of the most significant determinants of health. Growing wealth inequality, driven by rising housing costs, job insecurity, and disparities in education, continues to widen the health gap.

**"Evolution of Welfare Index per Level of Education (2015–2018)"** presents a graph that clearly illustrates that individuals with higher levels of education report higher welfare index scores. Those with higher professional or academic degrees (e.g., hbo-, wo-master, or doctor) consistently score above 7.6 on the index, whereas individuals with only primary education (basisonderwijs) score significantly lower, with the lowest point around 7.1 in 2017. Notably, the welfare index for lower-educated individuals fluctuates more across the years, highlighting their vulnerability to social or economic shifts. This indicates that education contributes not only to financial and employment stability but also to a more stable sense of well-being.

**"Perceived Health per Municipality (2012–2020)"** presents a graph that compares trends in perceived health in Amsterdam and Rotterdam. In 2012, Amsterdam reported a higher level of perceived health (73.9%) compared to Rotterdam (70.5%). While Amsterdam’s figure remained relatively stable until 2016 and then increased significantly to 78.2% in 2020, Rotterdam saw a dip to 68.4% in 2016 before rebounding to 74.1% in 2020. This rebound in Rotterdam appears linked to local health initiatives such as “Rotterdam Vitaal en Healthy,” aimed at promoting healthier habits in low-income neighborhoods. Likewise, “Amsterdam Vitaal & Gezond” was launched to improve health among vulnerable groups. These initiatives appear to have had a positive impact on the level of perceived health.

**"Correlation 'income & health'"** presents a map of the Netherlands showing regional correlations between income and health. Most areas are shaded in dark purple, indicating a strong positive correlation—high income corresponds to better perceived health. Only a few areas show a weak or even negative correlation (in yellow), and grey areas represent regions with insufficient data. This map emphasizes that the relationship between income and health is not only national but also deeply regional, with clear disparities between municipalities.

Together, these findings paint a consistent picture: both income and education are strongly linked to differences in health and well-being in the Netherlands. While national health policies remain essential, they are not sufficient on their own. The persistent regional and socioeconomic disparities call for targeted, localized approaches. Effective strategies must be informed by detailed regional data to identify where inequalities are most severe. By integrating health, education, and social policy, and investing particularly in vulnerable communities, we can create more equitable conditions that allow all citizens, regardless of income or background, to live healthier lives.

# Part 5 - Reproducibility

## 5.1 Github repository link

<https://github.com/TijsReijling/Programmeren>

## 5.2 Reference list

Data set sources include links to their corresponding metadata.

#Bovenaan welvaartsladder bijna 25 jaar langer in goede gezondheid. (2022, December 20). Centraal Bureau Voor De Statistiek. <https://www.cbs.nl/nl-nl/nieuws/2022/51/bovenaan-welvaartsladder-bijna-25-jaar-langer-in-goede-gezondheid>?

#Pharos. (2022, July). Sociaal economische Gezondheidsverschillen (SEGV). <https://www.pharos.nl/factsheets/sociaaleconomische-gezondheidsverschillen-segv/>

#Sociaaleconomische gezondheidsverschillen \| Volksgezondheid en Zorg. (n.d.). <https://www.vzinfo.nl/sociaaleconomische-gezondheidsverschillen>

Gezonde levensverwachting; inkomen en welvaart. (2025, May 23).[Data set]. CBS dataportaal. <https://opendata.cbs.nl/statline/portal.html?_la=nl&_catalog=CBS&tableId=85445NED&_theme=154>

Welzijn; kerncijfers, persoonskenmerken. (2025, March 20).[Data set]. CBS dataportaal. <https://opendata.cbs.nl/statline/portal.html?_la=nl&_catalog=CBS&tableId=85542NED&_theme=178>

Inkomen per gemeente en wijk, 2020. (2023, September 1).[Data set]. Centraal Bureau voor de Statisktiek. <https://www.cbs.nl/nl-nl/maatwerk/2023/35/inkomen-per-gemeente-en-wijk-2020> (metadata included in dataset)

Gezondheid per wijk en buurt; 2012/2016/2020/2022. (2024, December 09). [Data set]. RIVM dataportaal. <https://statline.rivm.nl/portal.html?_la=nl&_catalog=RIVM&tableId=50120NED&_theme=94>

Levensverwachting op de leeftijd 0 en 65 jaar; geslacht, regio 1996-2022. (2024, December 9). [Data set]. RIVM dataportaal. <https://statline.rivm.nl/portal.html?_la=nl&_catalog=RIVM&tableId=50132NED&_theme=101>
